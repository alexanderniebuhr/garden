---
import type { CollectionEntry } from "astro:content";

export const prerender = true;

import type {
	GetStaticPaths,
	InferGetStaticParamsType,
	InferGetStaticPropsType,
} from "astro";
import { getCollection, render } from "astro:content";
import Prose from "../../components/Prose.astro";
import Page from "../../layouts/Page.astro";

export const getStaticPaths = (async () => {
	const posts = await getCollection("blog");
	return posts.map((post) => {
		const [lang, ...id] = post.id.split("/");
		return {
			params: {
				locale: lang,
				id: id.join("/") || undefined,
			},
			props: post,
		};
	});
}) satisfies GetStaticPaths;

// type Params = InferGetStaticParamsType<typeof getStaticPaths>;
type Props = InferGetStaticPropsType<typeof getStaticPaths>;
const post = Astro.props;
const { Content } = await render(post);
---

<Page title={post.data.title}>
	<Prose>
		<Content />
	</Prose>
</Page>
